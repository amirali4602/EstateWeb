@page
@model IndexModel
@{
    ViewData["Title"] = "حساب کاربری";
    ViewData["ActivePage"] = ManageNavPages.Index;
}


<div class=" container mt-c mw-500">
    <div class="card shadow border-0 mt-5">
        <div class="card-header bg-primary bg-gradient ml-0 py-4">
            <div class="row">
                <div class="col-12 text-center">
                    <h1 class="py-2 text-dark fs-4">@ViewData["Title"]</h1>
                </div>
            </div>
        </div>
        <div class="card-body p-4">
            <div class="row">
                <div class="col-md-12">
                    @{
                        if (User.IsInRole(SD.Role_Admin) || User.IsInRole(SD.Role_Employee))
                        {
                            <section>
                                <h4 style="text-align:center" class="my-3"> عکس پروفایل</h4>
                                @{
                                    if (string.IsNullOrEmpty(Model.Input.ProfilePic) != true)
                                    {
                                        <img src="@Model.Input.ProfilePic" style="width:100%" class="mb-3" />

                                    }
                                }
                                <form id="account" method="post">
                                    <div asp-validation-summary="ModelOnly" class="text-danger" role="alert"></div>
                                    <input asp-for="Input.ProfilePic" hidden />

                                    <div class="form-floating mb-3">
                                        <input asp-for="Input.Name" class="form-control" placeholder="Please enter your name." />
                                        <label asp-for="Input.Name" class="form-label">نام</label>
                                    </div>
                                    <div class="form-floating mb-3">
                                        <input asp-for="Input.Role" class="form-control" placeholder="Please choose your username." disabled />
                                        <label asp-for="Input.Role" class="form-label">سمت</label>
                                    </div>
                                    <div class="form-floating mb-3">
                                        <input asp-for="Username" class="form-control" placeholder="Please choose your username." disabled />
                                        <label asp-for="Username" class="form-label">شماره تماس</label>
                                    </div>

                                    <div class="form-floating mb-3">
                                        <textarea asp-for="Input.Description" class="form-control" placeholder="Please Enter your Description." rows="10" style="height:100%;"></textarea>
                                        <label asp-for="Input.Description" class="form-label">توضیحات</label>
                                    </div>


                                    <div class="form-floating mb-3">
                                        <input asp-for="Input.Whatsapp" class="form-control" placeholder="Please enter your name." />
                                        <label asp-for="Input.Whatsapp" class="form-label"></label>
                                    </div>
                                    <div class="form-floating mb-3">
                                        <input asp-for="Input.Telegram" class="form-control" placeholder="Please enter your name." />
                                        <label asp-for="Input.Telegram" class="form-label"></label>
                                    </div>
                                    <div class="form-floating mb-3">
                                        <input asp-for="Input.Instagram" class="form-control" placeholder="Please enter your name." />
                                        <label asp-for="Input.Instagram" class="form-label"></label>
                                    </div>

                                    <div class="mb-3 row">
                                        <h4 style="text-align:center" class="my-3">محدوده فروش</h4>
                                        <div class="col-6">

                                            <input asp-for="Input.minRange" class="form-control " placeholder="Please choose your username." disabled />
                                            <label asp-for="Input.minRange" class="form-label">شروع رینج</label>


                                        </div>
                                        <div class="col-6">

                                            <input asp-for="Input.maxRange" class="form-control " placeholder="Please choose your username." disabled />
                                            <label asp-for="Input.maxRange" class="form-label">پایان رینج</label>


                                        </div>
                                    </div>

                                    <div class="form-floating mb-3">
                                        <input asp-for="Input.FeaturedMax" class="form-control" placeholder="Please choose your username." disabled />
                                        <label asp-for="Input.FeaturedMax" class="form-label"></label>
                                    </div>
                                    <div class="form-group">
                                        <label asp-for="Input.ProfilePic" class="control-label mb-3 text-primary"></label>
                                        <input type="file" class="form-control" accept="capture=camera,image/*" id="upload" oninput="process()" />

                                        <div>
                                            <img id="output" />
                                        </div>
                                    </div>
                                    <input type="hidden" name="base64Image" id="base64Image" />
                                    <div>
                                        <button id="profile-submit" type="submit" class="w-100 btn btn-lg btn-primary">ثبت تغییرات</button>
                                    </div>
                                    <div>
                                        <p>
                                            <a asp-page="../Register" asp-route-phoneNumber="@Model.Username">فراموشی رمز عبور</a>
                                        </p>
                                        <p>
                                            <a asp-page="./ChangePassword">تغییر رمز عبور</a>
                                        </p>
                                    </div>
                                </form>
                            </section>

                        }
                        else
                        {

                            <ul class="nav nav-tabs">
                                <li class="nav-item">
                                    <a href="#home" class="nav-link active" data-bs-toggle="tab">حساب من</a>
                                </li>
                                <li class="nav-item">
                                    <a href="#Ads" class="nav-link" data-bs-toggle="tab">آگهی های من</a>
                                </li>
                                <!--

                                <li class="nav-item">
                                    <a href="#Bookmarks" class="nav-link" data-bs-toggle="tab">نشان ها</a>
                                </li>
                                -->
                            </ul>
                            <div class="tab-content">
                                <div class="tab-pane fade show active" id="home">
                                    <form id="account" method="post">
                                        <div asp-validation-summary="ModelOnly" class="text-danger" role="alert"></div>

                                        <div class="form-floating mb-3">
                                            <input asp-for="Username" class="form-control" placeholder="Please choose your username." disabled />
                                            <label asp-for="Username" class="form-label"></label>
                                        </div>
                                        <div>
                                            <a asp-page="./ChangePassword" class="btn btn-outline-primary">تغییر رمز عبور</a>
                                        </div>
                                    </form>
                                </div>
                                <div class="tab-pane fade" id="Ads">
                                    @foreach (var page in Model.pageList)
                                    {
                                        <div class="card mb-3" style="max-width: 540px;">
                                            <div class="row g-0">
                                                <div class="col-sm-4">
                                                    <div class="ratio ratio-1x1 ">
                                                        <img src="@(page.ImageUrl)" class="img-fluid rounded-end object-fit-cover " alt="@(page.Title)" width="100" height="100">

                                                </div>

                                                </div>
                                                <div class="col-sm-8">
                                                    <div class="card-body">
                                                        <h5 class="card-title text-truncate">@(page.Title)</h5>
                                                        <div class="card-text">
                                                            @(page.Address)
                                                            
                                                        </div>
                                                        @if (page.isActive)
                                                        {
                                                            <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                                                                <div class="fs-6 text-dark fw-bold">
                                                                <small>
                                                                    @{
                                                                        if (!page.isRent)
                                                                        {
                                                                            Write("قیمت : " + page.PriceTotal.ToString("N0") + " تومان");
                                                                        }
                                                                        else if (page.Deposit != 0 && page.Rent != 0)
                                                                        {
                                                                            Write("رهن : " + page.Deposit.ToString("N0") + " تومان" + "\n" + "اجاره : " + page.Rent.ToString("N0") + " تومان");

                                                                        }
                                                                        else if (page.Deposit != 0)
                                                                        {
                                                                            Write("رهن : " + page.Deposit.ToString("N0") + " تومان");
                                                                        }
                                                                        else if (page.Rent != 0)
                                                                        {
                                                                            Write("اجاره : " + page.Rent.ToString("N0") + " تومان");

                                                                        }
                                                                    }
                                                                    </small>
                                                                </div>
                                                                <a asp-area="Customer" asp-action="Property" asp-route-PageId="@(page.PageId)" class="btn btn-primary">
                                                                    مشاهده
                                                                </a>
                                                            </div>

                                                        }
                                                        else if (page.AdsMessage != null && page.AdsMessage != "")
                                                        {
                                                            <div class="alert alert-danger p-0">
                                                                <i class="bi bi-exclamation-circle"></i>
                                                                @(page.AdsMessage)
                                                                    
                                                                
                                                            </div>
                                                        }

                                                        else
                                                        {
                                                            <div class="alert alert-primary p-0">
                                                                <i class="bi bi-exclamation-circle"></i>
                                                                منتظر تایید


                                                            </div>
                                                        }
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    }

                                </div>
                                <div class="tab-pane fade" id="Bookmarks">
                                    <p>Messages tab content ...</p>
                                </div>
                            </div>

                        }

                    }

                </div>
            </div>
        </div>
    </div>
</div>
@section Scripts {
    <script src="~/js/optimizer.js"></script>

    <script src="https://cdn.tiny.cloud/1/xc1furjetoq69vi18jmr01fd433nexfd2fbg21ej7enz242s/tinymce/7/tinymce.min.js" referrerpolicy="origin"></script>
    <script>
        tinymce.init({
            selector: 'textarea',
            plugins: 'anchor autolink charmap codesample emoticons image link lists media searchreplace table visualblocks wordcount',
            toolbar: 'undo redo | blocks fontfamily fontsize | bold italic underline strikethrough | link image media table mergetags | addcomment showcomments | typography | align lineheight | checklist numlist bullist indent outdent | emoticons charmap | removeformat',
            language: 'fa'
        });
    </script>
    <partial name="_ValidationScriptsPartial" />
}
